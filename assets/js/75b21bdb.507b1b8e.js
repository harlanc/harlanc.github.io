"use strict";(self.webpackChunktauri_docs=self.webpackChunktauri_docs||[]).push([[724],{5680:(e,n,t)=>{t.d(n,{xA:()=>c,yg:()=>b});var r=t(6540);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),p=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},c=function(e){var n=p(e.components);return r.createElement(l.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),u=p(t),m=a,b=u["".concat(l,".").concat(m)]||u[m]||d[m]||i;return t?r.createElement(b,s(s({ref:n},c),{},{components:t})):r.createElement(b,s({ref:n},c))}));function b(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,s=new Array(i);s[0]=m;var o={};for(var l in n)hasOwnProperty.call(n,l)&&(o[l]=n[l]);o.originalType=e,o[u]="string"==typeof e?e:a,s[1]=o;for(var p=2;p<i;p++)s[p]=t[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},6852:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>_,contentTitle:()=>f,default:()=>k,frontMatter:()=>b,metadata:()=>y,toc:()=>h});var r=t(5680),a=Object.defineProperty,i=Object.defineProperties,s=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,c=(e,n,t)=>n in e?a(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,u=(e,n)=>{for(var t in n||(n={}))l.call(n,t)&&c(e,t,n[t]);if(o)for(var t of o(n))p.call(n,t)&&c(e,t,n[t]);return e},d=(e,n)=>i(e,s(n)),m=(e,n)=>{var t={};for(var r in e)l.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&o)for(var r of o(e))n.indexOf(r)<0&&p.call(e,r)&&(t[r]=e[r]);return t};const b={sidebar_position:1},f="HTTP API",y={unversionedId:"docs/httpapi/http-api",id:"docs/httpapi/http-api",title:"HTTP API",description:"You can configure the service port in the configuration file: config service port",source:"@site/docs/docs/httpapi/http-api.md",sourceDirName:"docs/httpapi",slug:"/docs/httpapi/http-api",permalink:"/docs/httpapi/http-api",draft:!1,editUrl:"https://github.com/harlanc/xiu-doc/edit/main/docs/docs/httpapi/http-api.md",tags:[],version:"current",lastUpdatedAt:1717765048,formattedLastUpdatedAt:"Jun 7, 2024",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"docs",previous:{title:"Introduction",permalink:"/docs/httpapi/"},next:{title:"Record",permalink:"/docs/record/"}},_={},h=[{value:"Query Stream Information",id:"query-stream-information",level:2},{value:"Query the whole stream information",id:"query-the-whole-stream-information",level:3},{value:"Query specific stream",id:"query-specific-stream",level:3},{value:"Kickoff Client",id:"kickoff-client",level:2}],g={toc:h},v="wrapper";function k(e){var n=e,{components:t}=n,a=m(n,["components"]);return(0,r.yg)(v,d(u(u({},g),a),{components:t,mdxType:"MDXLayout"}),(0,r.yg)("h1",u({},{id:"http-api"}),"HTTP API"),(0,r.yg)("p",null,"You can configure the service port in the configuration file: ",(0,r.yg)("a",u({parentName:"p"},{href:"../configurations/config-file#http-api"}),"config service port")),(0,r.yg)("h2",u({},{id:"query-stream-information"}),"Query Stream Information"),(0,r.yg)("p",null,"Xiu has done some statistical work on the audio and video information of the stream, such as video resolution, bit rate, frame rate, etc., audio bit rate, sample rate, etc. (currently only supports the RTMP/HTTP-FLV protocol). You can use the following interface for querying"),(0,r.yg)("h3",u({},{id:"query-the-whole-stream-information"}),"Query the whole stream information"),(0,r.yg)("pre",null,(0,r.yg)("code",u({parentName:"pre"},{className:"language-shell"}),"curl http://localhost:8000/api/query_whole_streams\n")),(0,r.yg)("p",null,"The query result\uff1a"),(0,r.yg)("pre",null,(0,r.yg)("code",u({parentName:"pre"},{className:"language-json"}),'{\n    "error_code": 0,\n    "desp": "succ",\n    "data": [\n        {\n            "publisher": {\n                "id": "17105457865882",\n                "start_time": "2024-03-16T07:36:26.337103+08:00",\n                "identifier": {\n                    "rtmp": {\n                        "app_name": "live",\n                        "stream_name": "source1"\n                    }\n                },\n                "remote_address": "127.0.0.1:55687",\n                "audio": {\n                    "bitrate(kbits/s)": 128,\n                    "channels": 2,\n                    "profile": "LC",\n                    "samplerate": 44100,\n                    "sound_format": "AAC"\n                },\n                "video": {\n                    "bitrate(kbits/s)": 1802,\n                    "codec": "H264",\n                    "frame_rate": 20,\n                    "gop": 60,\n                    "height": 1280,\n                    "level": "3.0",\n                    "profile": "Main",\n                    "width": 720\n                },\n                "recv_bitrate(kbits/s)": 1802\n            },\n            "subscriber_count": 0,\n            "subscribers": {\n\n            },\n            "total_recv_bytes": 22674195,\n            "total_send_bytes": 0\n        },\n        {\n            //publisher information\n            "publisher": {\n                //uuid\n                "id": "17105458011883",\n                //start time of pushing stream\n                "start_time": "2024-03-16T07:36:41.109177+08:00",\n                //stream identifier information\n                "identifier": {\n                    "rtmp": {\n                        "app_name": "live",\n                        "stream_name": "source"\n                    }\n                },\n                //client ip and port\n                "remote_address": "127.0.0.1:55764",\n                //audio information of stream\n                "audio": {\n                    "bitrate(kbits/s)": 128,\n                    "channels": 2,\n                    "profile": "LC",\n                    "samplerate": 44100,\n                    "sound_format": "AAC"\n                },\n                //video information of stream\n                "video": {\n                    "bitrate(kbits/s)": 1814,\n                    "codec": "H264",\n                    "frame_rate": 20,\n                    "gop": 60,\n                    "height": 1280,\n                    "level": "3.0",\n                    "profile": "Main",\n                    "width": 720\n                },\n                "recv_bitrate(kbits/s)": 1814\n            },\n            "subscriber_count": 2,\n            "subscribers": {\n                "17105458497472": {\n                    //subscriber\'s uuid\n                    "id": "17105458497472",\n                    //client ip and port\n                    "remote_address": "127.0.0.1:56450",\n                    "send_bitrate(kbits/s)": 1943,\n                    //start time of pulling stream\n                    "start_time": "2024-03-16T07:37:29.034025+08:00",\n                    "sub_type": "PlayerRtmp",\n                    //Total data transmission amount from the start of pulling the stream to the queried time point\n                    "total_send_bytes(kbits/s)": 6616470\n                },\n                "17105458720121": {\n                    "id": "17105458720121",\n                    "remote_address": "127.0.0.1:56583",\n                    "send_bitrate(kbits/s)": 2362,\n                    "start_time": "2024-03-16T07:37:52.999917+08:00",\n                    "sub_type": "PlayerHttpFlv",\n                    "total_send_bytes(kbits/s)": 1524128\n                }\n            },\n            //Total amount of data received from the start of streaming to the current query time\n            "total_recv_bytes": 18823366,\n            //Total amount of data sent to all subscribers from the start of streaming to the current query time\n            "total_send_bytes": 8762803\n        }\n    ]\n}\n')),(0,r.yg)("p",null,"Query topN streams by stream's subscriber count\uff1a"),(0,r.yg)("pre",null,(0,r.yg)("code",u({parentName:"pre"},{className:"language-shell"}),"http://localhost:8000/api/query_whole_streams?top=1\n")),(0,r.yg)("pre",null,(0,r.yg)("code",u({parentName:"pre"},{className:"language-json"}),'{\n    "error_code": 0,\n    "desp": "succ",\n    "data": [\n        {\n            "publisher": {\n                "audio": {\n                    "bitrate(kbits/s)": 128,\n                    "channels": 2,\n                    "profile": "LC",\n                    "samplerate": 44100,\n                    "sound_format": "AAC"\n                },\n                "id": "17105458011883",\n                "identifier": {\n                    "rtmp": {\n                        "app_name": "live",\n                        "stream_name": "source"\n                    }\n                },\n                "recv_bitrate(kbits/s)": 1948,\n                "remote_address": "127.0.0.1:55764",\n                "start_time": "2024-03-16T07:36:41.109177+08:00",\n                "video": {\n                    "bitrate(kbits/s)": 1948,\n                    "codec": "H264",\n                    "frame_rate": 20,\n                    "gop": 60,\n                    "height": 1280,\n                    "level": "3.0",\n                    "profile": "Main",\n                    "width": 720\n                }\n            },\n            "subscriber_count": 2,\n            "subscribers": {\n                "17105458497472": {\n                    "id": "17105458497472",\n                    "remote_address": "127.0.0.1:56450",\n                    "send_bitrate(kbits/s)": 2076,\n                    "start_time": "2024-03-16T07:37:29.034025+08:00",\n                    "sub_type": "PlayerRtmp",\n                    "total_send_bytes(kbits/s)": 74392348\n                },\n                "17105458720121": {\n                    "id": "17105458720121",\n                    "remote_address": "127.0.0.1:56583",\n                    "send_bitrate(kbits/s)": 2076,\n                    "start_time": "2024-03-16T07:37:52.999917+08:00",\n                    "sub_type": "PlayerHttpFlv",\n                    "total_send_bytes(kbits/s)": 69300006\n                }\n            },\n            "total_recv_bytes": 91712283,\n            "total_send_bytes": 154540637\n        }\n    ]\n}\n')),(0,r.yg)("h3",u({},{id:"query-specific-stream"}),"Query specific stream"),(0,r.yg)("p",null,"Two parameters are supported: identifer and uuid. Identifier is a required field, while UUID is optional."),(0,r.yg)("p",null,"If only the identifier is specified, all information about this stream will be returned:"),(0,r.yg)("pre",null,(0,r.yg)("code",u({parentName:"pre"},{className:"language-shell"}),'curl -X POST -H "Content-Type: application/json" -d \'{\n     "identifier": {\n                "rtmp": {\n                    "app_name": "live",\n                    "stream_name": "source"\n                }\n            }\n}\' http://localhost:8000/api/query_stream\n')),(0,r.yg)("pre",null,(0,r.yg)("code",u({parentName:"pre"},{className:"language-json"}),'{\n    "error_code": 0,\n    "desp": "succ",\n    "data": [\n        {\n            "publisher": {\n                "audio": {\n                    "bitrate(kbits/s)": 128,\n                    "channels": 2,\n                    "profile": "LC",\n                    "samplerate": 44100,\n                    "sound_format": "AAC"\n                },\n                "id": "17105458011883",\n                "identifier": {\n                    "rtmp": {\n                        "app_name": "live",\n                        "stream_name": "source"\n                    }\n                },\n                "recv_bitrate(kbits/s)": 1948,\n                "remote_address": "127.0.0.1:55764",\n                "start_time": "2024-03-16T07:36:41.109177+08:00",\n                "video": {\n                    "bitrate(kbits/s)": 1948,\n                    "codec": "H264",\n                    "frame_rate": 20,\n                    "gop": 60,\n                    "height": 1280,\n                    "level": "3.0",\n                    "profile": "Main",\n                    "width": 720\n                }\n            },\n            "subscriber_count": 2,\n            "subscribers": {\n                "17105458497472": {\n                    "id": "17105458497472",\n                    "remote_address": "127.0.0.1:56450",\n                    "send_bitrate(kbits/s)": 2076,\n                    "start_time": "2024-03-16T07:37:29.034025+08:00",\n                    "sub_type": "PlayerRtmp",\n                    "total_send_bytes(kbits/s)": 74392348\n                },\n                "17105458720121": {\n                    "id": "17105458720121",\n                    "remote_address": "127.0.0.1:56583",\n                    "send_bitrate(kbits/s)": 2076,\n                    "start_time": "2024-03-16T07:37:52.999917+08:00",\n                    "sub_type": "PlayerHttpFlv",\n                    "total_send_bytes(kbits/s)": 69300006\n                }\n            },\n            "total_recv_bytes": 91712283,\n            "total_send_bytes": 154540637\n        }\n    ]\n}\n')),(0,r.yg)("p",null,"If both the identifier and the subscriber's UUID are specified, only the information of the specified subscriber will be retained, and the information of other subscribers will be filtered out:"),(0,r.yg)("pre",null,(0,r.yg)("code",u({parentName:"pre"},{className:"language-shell"}),'curl -X POST -H "Content-Type: application/json" -d \'{\n     "identifier": {\n                "rtmp": {\n                    "app_name": "live",\n                    "stream_name": "source"\n                }\n            },\n     "uuid": "17105458497472"\n}\' http://localhost:8000/api/query_stream\n')),(0,r.yg)("pre",null,(0,r.yg)("code",u({parentName:"pre"},{className:"language-json"}),'{\n    "error_code": 0,\n    "desp": "succ",\n    "data": [\n        {\n            "publisher": {\n                "audio": {\n                    "bitrate(kbits/s)": 127,\n                    "channels": 2,\n                    "profile": "LC",\n                    "samplerate": 44100,\n                    "sound_format": "AAC"\n                },\n                "id": "17105458011883",\n                "identifier": {\n                    "rtmp": {\n                        "app_name": "live",\n                        "stream_name": "source"\n                    }\n                },\n                "recv_bitrate(kbits/s)": 1782,\n                "remote_address": "127.0.0.1:55764",\n                "start_time": "2024-03-16T07:36:41.109177+08:00",\n                "video": {\n                    "bitrate(kbits/s)": 1782,\n                    "codec": "H264",\n                    "frame_rate": 20,\n                    "gop": 60,\n                    "height": 1280,\n                    "level": "3.0",\n                    "profile": "Main",\n                    "width": 720\n                }\n            },\n            "subscriber_count": 2,\n            "subscribers": {\n                "17105458497472": {\n                    "id": "17105458497472",\n                    "remote_address": "127.0.0.1:56450",\n                    "send_bitrate(kbits/s)": 1910,\n                    "start_time": "2024-03-16T07:37:29.034025+08:00",\n                    "sub_type": "PlayerRtmp",\n                    "total_send_bytes(kbits/s)": 219407398\n                }\n            },\n            "total_recv_bytes": 247625063,\n            "total_send_bytes": 466366197\n        }\n    ]\n}\n')),(0,r.yg)("p",null,"If both the identifier and the publisher's UUID are specified, all subscribers' information will be filtered out:"),(0,r.yg)("pre",null,(0,r.yg)("code",u({parentName:"pre"},{className:"language-shell"}),'curl -X POST -H "Content-Type: application/json" -d \'{\n     "identifier": {\n                "rtmp": {\n                    "app_name": "live",\n                    "stream_name": "source"\n                }\n            },\n     "uuid": "17105458011883"\n}\' http://localhost:8000/api/query_stream\n')),(0,r.yg)("pre",null,(0,r.yg)("code",u({parentName:"pre"},{className:"language-json"}),'{\n    "error_code": 0,\n    "desp": "succ",\n    "data": [\n        {\n            "publisher": {\n                "audio": {\n                    "bitrate(kbits/s)": 128,\n                    "channels": 2,\n                    "profile": "LC",\n                    "samplerate": 44100,\n                    "sound_format": "AAC"\n                },\n                "id": "17105458011883",\n                "identifier": {\n                    "rtmp": {\n                        "app_name": "live",\n                        "stream_name": "source"\n                    }\n                },\n                "recv_bitrate(kbits/s)": 1835,\n                "remote_address": "127.0.0.1:55764",\n                "start_time": "2024-03-16T07:36:41.109177+08:00",\n                "video": {\n                    "bitrate(kbits/s)": 1835,\n                    "codec": "H264",\n                    "frame_rate": 20,\n                    "gop": 60,\n                    "height": 1280,\n                    "level": "3.0",\n                    "profile": "Main",\n                    "width": 720\n                }\n            },\n            "subscriber_count": 2,\n            "subscribers": {\n\n            },\n            "total_recv_bytes": 311877631,\n            "total_send_bytes": 594871333\n        }\n    ]\n}\n')),(0,r.yg)("h2",u({},{id:"kickoff-client"}),"Kickoff Client"),(0,r.yg)("p",null,"The business users can kickoff illegal push/pull clients using the following interface:"),(0,r.yg)("pre",null,(0,r.yg)("code",u({parentName:"pre"},{className:"language-shell"}),'curl -X POST -H "Content-Type: application/json" -d \'{"id": "17079922471661"}\' http://localhost:8000/kick_off_client\n')))}k.isMDXComponent=!0}}]);